<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>R√©sidence Thalassa ¬∑ Copropri√©t√© √éle aux Bahamas</title>
  <style>
    :root {
      --blue: #0f7bff;
      --purple: #8245ff;
      --green: #12b886;
      --amber: #f59f00;
      --red: #f03e3e;
      --bg: #eef4ff;
      --text: #0f172a;
      --muted: #4b5563;
      --card: rgba(255, 255, 255, 0.9);
      --shadow: 0 18px 40px rgba(15, 27, 45, 0.18);
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Inter", system-ui, -apple-system, sans-serif;
      background: radial-gradient(circle at 18% 20%, #d7e8ff 0, #b2d4ff 25%, #7fb3ff 55%, #3a6cf6 100%);
      color: var(--text);
      min-height: 100vh;
    }

    .page {
      max-width: 1200px;
      margin: 0 auto;
      padding: 28px 18px 64px;
    }

    header {
      position: sticky;
      top: 0;
      z-index: 30;
      padding-bottom: 18px;
      backdrop-filter: blur(14px);
    }

    .nav {
      background: rgba(255, 255, 255, 0.92);
      border: 1px solid rgba(255, 255, 255, 0.6);
      border-radius: 18px;
      padding: 14px 18px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      box-shadow: var(--shadow);
    }

    .nav-links {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      color: var(--muted);
      font-weight: 600;
    }
    .nav-links a {
      text-decoration: none;
      color: inherit;
      padding: 8px 10px;
      border-radius: 10px;
      transition: background 0.2s ease, color 0.2s ease;
    }
    .nav-links a:hover { background: rgba(15, 123, 255, 0.08); color: var(--text); }

    .brand {
      display: flex;
      gap: 12px;
      align-items: center;
      font-weight: 800;
      letter-spacing: 0.04em;
      color: var(--blue);
    }

    .brand .pill {
      padding: 8px 12px;
      border-radius: 999px;
      background: linear-gradient(135deg, var(--blue), var(--purple));
      color: #fff;
      font-size: 12px;
      font-weight: 700;
    }

    .nav-actions { display: flex; gap: 8px; flex-wrap: wrap; }

    button {
      border: none;
      cursor: pointer;
      font-weight: 700;
      border-radius: 12px;
      transition: transform 0.18s ease, box-shadow 0.18s ease, background 0.18s ease;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--blue), var(--purple));
      color: white;
      padding: 12px 16px;
      box-shadow: 0 12px 30px rgba(15, 123, 255, 0.3);
    }

    .btn-ghost {
      background: rgba(15, 123, 255, 0.08);
      color: var(--blue);
      padding: 11px 14px;
      border: 1px solid rgba(15, 123, 255, 0.18);
    }

    button:hover { transform: translateY(-1px); box-shadow: var(--shadow); }

    .grid { display: grid; gap: 18px; }

    .hero {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.97), rgba(255, 255, 255, 0.9));
      padding: 26px;
      border-radius: 20px;
      border: 1px solid rgba(255, 255, 255, 0.7);
      box-shadow: var(--shadow);
      display: grid;
      gap: 16px;
    }

    .hero h1 { margin: 0; font-size: clamp(30px, 5vw, 44px); color: var(--text); }
    .hero p { margin: 6px 0 0; color: var(--muted); line-height: 1.6; }

    .section {
      background: var(--card);
      border-radius: 18px;
      padding: 20px;
      border: 1px solid rgba(255, 255, 255, 0.75);
      box-shadow: var(--shadow);
    }

    .section h2 { margin: 0 0 10px; color: var(--text); }
    .section .subtitle { color: var(--muted); margin-bottom: 12px; }

    .chips { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px; }
    .chip {
      padding: 8px 12px;
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.72);
      border: 1px solid rgba(0, 0, 0, 0.05);
      color: var(--muted);
    }

    .kpis { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 10px; }
    .kpi {
      background: rgba(255, 255, 255, 0.9);
      border: 1px solid rgba(255, 255, 255, 0.7);
      border-radius: 14px;
      padding: 12px;
      box-shadow: var(--shadow);
      display: grid;
      gap: 6px;
    }
    .kpi .label { color: var(--muted); font-size: 13px; }
    .kpi .value { font-size: 22px; font-weight: 800; color: var(--text); }

    .lot-toolbar { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; margin-bottom: 14px; }
    .filter {
      padding: 8px 12px;
      border-radius: 10px;
      background: rgba(15, 123, 255, 0.1);
      color: var(--blue);
      border: 1px solid rgba(15, 123, 255, 0.2);
      cursor: pointer;
    }

    .lot-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 12px; }

    .lot-card {
      padding: 14px;
      border-radius: 14px;
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.96), rgba(255, 255, 255, 0.86));
      border: 1px solid rgba(0, 0, 0, 0.04);
      box-shadow: 0 10px 24px rgba(0, 0, 0, 0.08);
      display: grid;
      gap: 8px;
    }

    .lot-head { display: flex; justify-content: space-between; align-items: center; gap: 6px; }
    .badge {
      border-radius: 999px;
      padding: 6px 10px;
      font-size: 12px;
      font-weight: 800;
      color: #fff;
    }
    .b-dispo { background: var(--green); }
    .b-occupe { background: var(--amber); }
    .b-indispo { background: var(--red); }

    .meta { color: var(--muted); font-size: 14px; }

    .tab-wrapper { margin: 18px 0; }
    .tabs { display: flex; gap: 10px; flex-wrap: wrap; }
    .tab {
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(0,0,0,0.05);
      background: rgba(255,255,255,0.8);
      cursor: pointer;
      font-weight: 700;
      color: var(--muted);
    }
    .tab.active { background: linear-gradient(135deg, rgba(15,123,255,0.1), rgba(130,69,255,0.12)); color: var(--text); border-color: rgba(15,123,255,0.22); }

    .tab-panels { margin-top: 12px; }
    .tab-panel { display: none; background: rgba(255,255,255,0.88); border-radius: 14px; padding: 14px; border: 1px solid rgba(0,0,0,0.04); box-shadow: var(--shadow); }
    .tab-panel.active { display: grid; gap: 10px; }

    .accordion { border: 1px solid rgba(0,0,0,0.05); border-radius: 12px; overflow: hidden; }
    .accordion-item + .accordion-item { border-top: 1px solid rgba(0,0,0,0.05); }
    .accordion-header { padding: 12px 14px; background: rgba(255,255,255,0.85); display: flex; justify-content: space-between; align-items: center; cursor: pointer; font-weight: 700; }
    .accordion-content { padding: 0 14px 14px; display: none; color: var(--muted); line-height: 1.5; }
    .accordion-item.open .accordion-content { display: block; }

    .badge-soft { padding: 6px 10px; border-radius: 10px; background: rgba(15,123,255,0.08); color: var(--blue); font-weight: 700; }
    .grid-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 12px; }
    .card-sm { background: rgba(255,255,255,0.9); border-radius: 12px; padding: 12px; border: 1px solid rgba(0,0,0,0.05); box-shadow: var(--shadow); display: grid; gap: 6px; }
    .flag { display: inline-flex; align-items: center; gap: 6px; font-weight: 800; }

    form { display: grid; gap: 14px; }
    label { display: grid; gap: 6px; font-weight: 700; color: var(--text); }
    input, select, textarea {
      border: 1px solid rgba(0, 0, 0, 0.08);
      border-radius: 12px;
      padding: 12px;
      background: rgba(255, 255, 255, 0.9);
      font-size: 15px;
      font-family: inherit;
      color: var(--text);
      box-shadow: inset 0 2px 6px rgba(15, 27, 45, 0.04);
    }
    textarea { min-height: 110px; resize: vertical; }

    .two-col { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 12px; }

    .table { width: 100%; border-collapse: collapse; }
    .table th, .table td { text-align: left; padding: 10px 8px; }
    .table th { color: var(--muted); font-weight: 700; font-size: 13px; }
    .table tr { background: rgba(255, 255, 255, 0.7); border-radius: 10px; }
    .table tr + tr td { border-top: 1px solid rgba(0, 0, 0, 0.05); }
    .table td input, .table td select, .table td textarea { width: 100%; font-size: 14px; }

    .admin-bar { display: flex; justify-content: space-between; align-items: center; gap: 12px; flex-wrap: wrap; }
    .status-dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; }
    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #fff;
      border-radius: 12px;
      padding: 14px 16px;
      box-shadow: var(--shadow);
      color: var(--text);
      opacity: 0;
      transform: translateY(10px);
      transition: 0.2s ease;
      z-index: 50;
    }
    .toast.show { opacity: 1; transform: translateY(0); }

    .pill-list { display: flex; flex-wrap: wrap; gap: 6px; }
    .pill-box { background: rgba(15, 123, 255, 0.06); color: var(--text); padding: 8px 10px; border-radius: 10px; }

    .hidden { display: none !important; }

    @media (max-width: 720px) {
      .nav { flex-direction: column; align-items: flex-start; }
      .lot-head { flex-direction: column; align-items: flex-start; }
    }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <div class="nav">
        <div class="brand">
          <div class="pill">√éle aux Bahamas</div>
          <div>R√©sidence Thalassa</div>
        </div>
      <div class="nav-links">
          <a href="#hero">Accueil</a>
          <a href="#tabs">Onglets</a>
          <a href="#copro">Vie de copro</a>
          <a href="#services">Services</a>
          <a href="#ag2025">Derni√®re AG</a>
          <a href="#agenda">Agenda</a>
          <a href="#faq">FAQ</a>
          <a href="#demandes">Demandes</a>
        </div>
        <div class="nav-actions">
          <button class="btn-ghost" onclick="downloadReglement()">üìÑ T√©l√©charger le r√®glement</button>
          <button class="btn-primary" onclick="openAdmin()">üîê Espace administrateur</button>
        </div>
      </div>
    </header>

    <section id="hero" class="hero">
      <div>
        <h1>Cabanons sur pilotis ¬∑ r√©sidence priv√©e & partag√©e</h1>
        <p>Plage, ponton, terrains de beach-volley et golf, port privatif : la copropri√©t√© Thalassa offre un cadre exceptionnel pour vivre le r√™ve des Bahamas. Les copropri√©taires disposent d‚Äôoutils pour la vie sur place, la maintenance et les documents cl√©s, sans aucune logique de r√©servation.</p>
      </div>
      <div class="chips">
        <div class="chip">Ponton / plage / port privatif</div>
        <div class="chip">Terrain de beach-volley & golf</div>
        <div class="chip">R√®glement clair ¬∑ respect de la faune</div>
        <div class="chip">Administration s√©curis√©e TALASSA</div>
      </div>
      <div class="kpis" id="kpiRow"></div>
    </section>

    <section id="tabs" class="section">
      <div class="tab-wrapper">
        <div class="tabs" id="tabsNav"></div>
        <div class="tab-panels" id="tabsPanels"></div>
      </div>
    </section>

    <section class="section" id="copro">
      <h2>Options & services pour copropri√©taires</h2>
      <p class="subtitle">Des outils concrets pour la vie sur l‚Äô√Æle, l‚Äôentretien des cabanons et la coordination entre copropri√©taires.</p>
      <div class="grid-cards">
        <div class="card-sm">
          <div class="flag">üõ†Ô∏è Maintenance express</div>
          <div class="meta">D√©clarez incidents techniques, d√©clenchez une intervention, suivez le statut en temps r√©el.</div>
        </div>
        <div class="card-sm">
          <div class="flag">üß∫ Conciergerie m√©nage</div>
          <div class="meta">Planning partag√© de m√©nage des cabanons, rotation hebdomadaire et kit de nettoyage fourni.</div>
        </div>
        <div class="card-sm">
          <div class="flag">üóÇÔ∏è Documents copro</div>
          <div class="meta">R√®glement, EDD, composition du bureau, comptes rendus et PV d‚ÄôAG accessibles hors connexion.</div>
        </div>
        <div class="card-sm">
          <div class="flag">üõü Port & s√©curit√©</div>
          <div class="meta">Badges num√©riques, suivi des autorisations, rappel des consignes et de l‚Äôutilisation du port privatif.</div>
        </div>
        <div class="card-sm">
          <div class="flag">üèê Sports & loisirs</div>
          <div class="meta">Tableau de cr√©neaux partag√© pour le beach-volley et le golf, sans r√©servation obligatoire.</div>
        </div>
        <div class="card-sm">
          <div class="flag">ü§ù Vie communautaire</div>
          <div class="meta">Forum d‚Äôannonces, √©changes de mat√©riel, entraide pour arriv√©es/d√©parts et √©v√©nements sur place.</div>
        </div>
      </div>
    </section>

    <section class="section" id="services">
      <h2>Services sur site et confort quotidien</h2>
      <p class="subtitle">Des onglets d√©di√©s aux loisirs, √† la logistique et aux garanties pour un site digne d'un vrai resort.</p>
      <div class="grid-cards" id="servicesGrid"></div>
    </section>

    <section class="section" id="agenda">
      <h2>Agenda & jalons</h2>
      <p class="subtitle">Toutes les √©tapes pour la pr√©sentation orale du 28 novembre et le suivi de la copropri√©t√©.</p>
      <div class="grid-cards">
        <div class="card-sm">
          <div class="flag">üé§ Pr√©sentation orale</div>
          <div class="meta">28 novembre ¬∑ Copro physiquement</div>
          <div class="badge-soft">Salle & lieu confirm√©s une semaine avant</div>
        </div>
        <div class="card-sm">
          <div class="flag">üìë R√®glement</div>
          <div class="meta">Niveau 5/6 ¬∑ EDD et composition inclus</div>
          <div class="badge-soft">T√©l√©chargeable, mis √† jour √† chaque r√©vision</div>
        </div>
        <div class="card-sm">
          <div class="flag">üõ•Ô∏è Parties communes</div>
          <div class="meta">Ponton, plage, port privatif, terrains sportifs</div>
          <div class="badge-soft">D√©finition & conditions de jouissance</div>
        </div>
        <div class="card-sm">
          <div class="flag">üìå Lieu</div>
          <div class="meta">√éle aux Bahamas ¬∑ R√©sidence Thalassa</div>
          <div class="badge-soft">Acc√®s bateau + a√©rien d√©taill√© dans les onglets</div>
        </div>
      </div>
    </section>

    <section class="section" id="ag2025">
      <h2>Derni√®re Assembl√©e G√©n√©rale ¬∑ 12 mars 2025</h2>
      <p class="subtitle">Proc√®s-verbal complet de l‚ÄôAG des copropri√©taires de la R√©sidence TALASSA ‚Äî √éle du Levant, salle polyvalente.</p>
      <div class="grid-cards">
        <div class="card-sm">
          <div class="flag">üßæ Composition du bureau</div>
          <div class="meta">Pr√©sident : M. Dupond ¬∑ Scrutateur : Mme Flament ¬∑ Secr√©taire : Mme Petit</div>
          <div class="badge-soft">S√©ance ouverte √† 17h15 ¬∑ 10 000 / 10 000 tanti√®mes pr√©sents ou repr√©sent√©s</div>
        </div>
        <div class="card-sm">
          <div class="flag">üìã Ordre du jour</div>
          <div class="meta">D√©termination des destinations privatives et communes, conditions de jouissance, r√®gles d‚Äôadministration.</div>
          <div class="meta">Lieu : √éle du Levant ¬∑ R√©sidence TALASSA ¬∑ Port privatif et salle polyvalente.</div>
        </div>
        <div class="card-sm">
          <div class="flag">‚úÖ R√©solution adopt√©e</div>
          <div class="meta">Autorisation de pratiquer le naturisme sur la parcelle d‚Äôeau privative de chaque copropri√©taire.</div>
          <div class="badge-soft">Majorit√© Article 24 ‚Äî Vote : pour (tous sauf Mme Solou), contre (Mme Solou).</div>
        </div>
        <div class="card-sm">
          <div class="flag">‚ùå R√©solutions rejet√©es</div>
          <div class="meta">1) Naturisme dans toutes les parties communes.</div>
          <div class="meta">2) Naturisme dans les parties communes entre 00h00 et 06h00.</div>
          <div class="meta">3) Naturisme sur une zone commune d√©di√©e en bord de mer.</div>
        </div>
      </div>
      <div class="section" style="margin-top:14px; background: rgba(255,255,255,0.85);">
        <div class="admin-bar">
          <div>
            <div class="flag">üìù Proc√®s-verbal d√©taill√©</div>
            <div class="meta">Texte int√©gral pour archivage et consultation hors connexion.</div>
          </div>
          <button class="btn-ghost" onclick="downloadReglement()">üìÑ T√©l√©charger r√®glement & PV</button>
        </div>
        <div class="meta" style="white-space: pre-line; line-height: 1.6; margin-top: 10px;">
PROC√àS-VERBAL DE L‚ÄôASSEMBL√âE G√âN√âRALE DES COPROPRI√âTAIRES
R√©sidence TALASSA ¬∑ √éle du Levant ‚Äî 12 mars 2025, 17h00
Les copropri√©taires, r√©guli√®rement convoqu√©s par le syndic, sont r√©unis en Assembl√©e G√©n√©rale dans la salle polyvalente. La feuille de pr√©sence √©marg√©e constate 10 000 / 10 000 tanti√®mes.

COMPOSITION DU BUREAU
Pr√©sident de s√©ance : M. DUPOND ¬∑ Scrutateur : Mme FLAMENT ¬∑ Secr√©taire : Mme PETIT
Ouverture de s√©ance : 17h15.

LISTE DES COPROPRI√âTAIRES ET TANTI√àMES
Tableau fourni par le syndicat ‚Äî voir document annexe.

R√âSOLUTIONS
1 ‚Äî Autorisation du naturisme dans les parties communes
Majorit√© : Article 25. Ont vot√© contre : Mme LEGRAND, M. LAMBLIN, M. VIVIER, Mme SOLOU. R√©sultat : rejet√©e.
2 ‚Äî Naturisme dans les parties communes entre 00h00 et 06h00
Majorit√© : Article 25. Ont vot√© contre : Mme LEGRAND, M. LAMBLIN, M. VIVIER, Mme SOLOU. R√©sultat : rejet√©e.
3 ‚Äî Naturisme sur une zone d√©di√©e des parties communes
Majorit√© : Article 25. Ont vot√© contre : Mme LEGRAND, M. LAMBLIN, M. VIVIER, Mme SOLOU. R√©sultat : rejet√©e.
4 ‚Äî Naturisme sur la parcelle d‚Äôeau privative de chaque copropri√©taire
Majorit√© : Article 24. Ont vot√© contre : Mme SOLOU. Ont vot√© pour : tous les autres copropri√©taires. R√©sultat : adopt√©e.

CL√îTURE DE S√âANCE
Plus aucune question n‚Äô√©tant pos√©e, la s√©ance est lev√©e √† 19h05.
Pr√©sident : M. DUPOND ¬∑ Secr√©taire : Mme PETIT ¬∑ Scrutateur : Mme FLAMENT.
Proc√®s-verbal certifi√© conforme par le syndic de la R√©sidence TALASSA.
        </div>
      </div>
    </section>

    <section class="section" id="demandes">
      <div class="admin-bar">
        <div>
          <h2>Demande d'information</h2>
          <p class="subtitle">Questions copropri√©taires, signalements ou besoins logistiques. Sauvegarde automatique toutes les 30 secondes et √† chaque modification.</p>
        </div>
        <button class="btn-ghost" onclick="resetDraft()">R√©initialiser le brouillon</button>
      </div>
      <form id="requestForm">
        <div class="two-col">
          <label>Nom et pr√©nom
            <input name="name" required placeholder="Votre nom" />
          </label>
          <label>Email
            <input name="email" type="email" required placeholder="vous@example.com" />
          </label>
        </div>
        <div class="two-col">
          <label>T√©l√©phone
            <input name="phone" required placeholder="+33..." />
          </label>
          <label>Lot concern√©
            <select name="lot" id="lotSelect" required></select>
          </label>
        </div>
        <label>Message
          <textarea name="message" placeholder="Pr√©cisez vos besoins, disponibilit√©s de visite, etc." required></textarea>
        </label>
        <button class="btn-primary" type="submit">Envoyer la demande</button>
        <div id="draftStatus" class="meta"></div>
      </form>
    </section>

    <section class="section">
      <h2>R√®glement de copropri√©t√©</h2>
      <p class="subtitle">Fixe la destination des parties privatives et communes, et les conditions de leur jouissance.</p>
      <ul class="meta">
        <li>Pas de bruit apr√®s 00h (respect du voisinage et de la faune locale).</li>
        <li>Animaux autoris√©s s‚Äôils ne troublent pas la tranquillit√©.</li>
        <li>Utilisation du port r√©serv√©e aux r√©sidents (1 place par cabanon).</li>
        <li>Plage et ponton : usage collectif, interdiction de privatiser des zones.</li>
        <li>Terrain de beach-volley & golf : cr√©neaux partag√©s affich√©s sur place, sans r√©servation.</li>
        <li>Propret√© : chaque r√©sident veille √† la propret√© des lieux communs.</li>
        <li>Interdiction de feu de camp ou barbecue hors zones pr√©vues.</li>
      </ul>
      <div class="chips">
        <div class="chip">Pr√©sentation orale : 28 novembre</div>
        <div class="chip">Copro physiquement : lieu √† confirmer</div>
        <div class="chip">EDD & r√®glement : niveau 5/6</div>
        <div class="chip">Comit√© : composition en cours</div>
      </div>
      <div style="margin-top:12px;">
        <button class="btn-ghost" onclick="downloadReglement()">üì• Exporter le r√®glement (PDF)</button>
      </div>
    </section>

    <section class="section" id="faq">
      <h2>Questions fr√©quentes</h2>
      <div class="accordion" id="faqAccordion"></div>
    </section>

    <section id="adminPanel" class="section hidden">
      <div class="admin-bar">
        <h2>Administration TALASSA</h2>
        <button class="btn-ghost" onclick="logout()">Se d√©connecter</button>
      </div>
      <div class="subtitle">Consulter et √©diter toutes les demandes envoy√©es par les copropri√©taires. Tout est sauvegard√© localement et reste accessible hors connexion apr√®s authentification.</div>

      <h3>Demandes re√ßues</h3>
      <div class="section" style="padding:12px; background: rgba(255,255,255,0.8);">
        <table class="table" id="requestsTable"></table>
      </div>
    </section>
  </div>

  <div id="toast" class="toast"></div>

  <script>
    const reqKey = 'thalassa_requests_v3';
    const draftKey = 'thalassa_draft_v3';
    const lotNames = Array.from({ length: 25 }, (_, i) => `Lot ${i + 1} ‚Äî T4 ¬∑ 40 m¬≤`);
    let isAdmin = false;

    const tabDefinitions = [
      { id: 'lieu', titre: 'Lieu & acc√®s', points: [
        '√éle aux Bahamas, cabanons sur pilotis avec plage et ponton',
        'Navettes bateau programm√©es ¬∑ station d‚Äôaccueil s√©curis√©e',
        'Accueil bagagerie, conciergerie et maintenance sur place',
        'Bornes √©lectriques et zones techniques d√©di√©es'
      ]},
      { id: 'services-copro', titre: 'Services copropri√©taires', points: [
        'Conciergerie propri√©taires (maintenance, m√©nage, √©quipements)',
        'Suivi des travaux, incidents et tableaux d‚Äôaffichage partag√©s',
        'Cl√©s num√©riques, badges port, et kit d‚Äôaccueil copropri√©taire'
      ]},
      { id: 'vie', titre: 'Vie de l‚Äô√Æle', points: [
        '25 cabanons T4 d√©di√©s aux copropri√©taires, non destin√©s √† la location',
        '√âchanges entre voisins, entraide et annonces internes dans l‚Äôonglet communaut√©',
        'Tableau de bord des interventions et de la propret√© partag√©e'
      ]},
      { id: 'ag', titre: 'AG 12 mars 2025', points: [
        'Assembl√©e G√©n√©rale tenue le 12 mars 2025 √† 17h00 (10 000 / 10 000 tanti√®mes)',
        'Bureau : Pr√©sident M. Dupond ¬∑ Scrutateur Mme Flament ¬∑ Secr√©taire Mme Petit',
        'R√©solutions naturisme : trois rejet√©es, une adopt√©e (parcelle d‚Äôeau privative)'
      ]},
      { id: 'documents', titre: 'Documents', points: [
        'R√®glement t√©l√©chargeable en PDF',
        'EDD et composition annex√©s',
        'Compte-rendus de visites et de pr√©sentation' ]}
    ];

    const services = [
      { icon: 'üèùÔ∏è', titre: 'Acc√®s plage & ponton', texte: 'Pass prioritaire pour les r√©sidents, surveillance et √©clairage doux nocturne.' },
      { icon: '‚õµ', titre: 'Port privatif', texte: 'Place d√©di√©e par cabanon, badges s√©curis√©s, assistance amarrage.' },
      { icon: 'üèê', titre: 'Sports & loisirs', texte: 'Terrains en cr√©neaux partag√©s (tableau affich√©), sans principe de r√©servation.' },
      { icon: 'üßπ', titre: 'Propret√© & maintenance', texte: '√âquipe de m√©nage tournante, suivi des interventions et planification visible.' },
      { icon: 'ü¶ú', titre: 'Respect de la faune', texte: 'Silence apr√®s minuit, √©clairage basse intensit√©, indicateurs ‚Äúqui√©tude‚Äù.' },
      { icon: 'üõ∞Ô∏è', titre: 'Connectivit√©', texte: 'Wifi maill√©, sauvegarde locale des demandes et des documents pour usage hors connexion.' },
      { icon: 'üõü', titre: 'S√©curit√©', texte: 'Vid√©osurveillance discr√®te, num√©ros d‚Äôurgence et d√©fibrillateur signal√©s.' },
      { icon: 'ü§ù', titre: 'Communaut√©', texte: 'Espace d‚Äôannonces internes, entraide et partage d‚Äô√©quipements entre copropri√©taires.' }
    ];

    const faq = [
      { q: 'Comment acc√©der √† la r√©sidence ?', a: 'Par navette bateau d√©di√©e (port privatif) ou par l‚Äôa√©roport voisin avec transfert organis√© par la conciergerie.' },
      { q: 'Puis-je venir avec des animaux ?', a: 'Oui, s‚Äôils ne troublent pas la tranquillit√©. Les promenades sont conseill√©es en dehors des zones calmes apr√®s 20h.' },
      { q: 'Comment s‚Äôorganisent les terrains de sport ?', a: 'Cr√©neaux affich√©s sur tableau partag√© dans l‚Äôonglet Sports & Loisirs, sans r√©servation ni statut de lot.' },
      { q: 'Les demandes copro sont-elles publiques ?', a: 'Non. Seuls les administrateurs connect√©s (TALASSA / TALASSAVIVEZLEREVE) peuvent consulter et √©diter les demandes.' },
      { q: 'O√π trouver les documents officiels ?', a: 'Dans la section Documents et via le bouton de t√©l√©chargement du r√®glement et du PV.' }
    ];

    function populateLotOptions() {
      const sel = document.getElementById('lotSelect');
      sel.innerHTML = '<option value="">S√©lectionner un lot</option>' + lotNames.map(l => `<option value="${l}">${l}</option>`).join('');
    }

    function loadRequests() {
      return JSON.parse(localStorage.getItem(reqKey) || '[]');
    }
    function saveRequests(reqs) { localStorage.setItem(reqKey, JSON.stringify(reqs)); }

    function submitRequest(e) {
      e.preventDefault();
      const form = e.target;
      const data = Object.fromEntries(new FormData(form).entries());
      const requests = loadRequests();
      requests.push({ ...data, statut: 'Nouvelle', id: crypto.randomUUID(), date: new Date().toISOString() });
      saveRequests(requests);
      localStorage.removeItem(draftKey);
      form.reset();
      updateDraftStatus('Demande enregistr√©e et envoy√©e au gestionnaire.');
      toast('Demande envoy√©e. Elle est visible par l'administrateur uniquement.');
      renderRequests();
      updateKpis();
    }

    function renderRequests() {
      if (!isAdmin) return;
      const table = document.getElementById('requestsTable');
      const reqs = loadRequests();
      if (!reqs.length) {
        table.innerHTML = '<tr><td class="meta">Aucune demande pour le moment.</td></tr>';
        return;
      }
      table.innerHTML = `
        <tr>
          <th>Nom</th><th>Email</th><th>T√©l√©phone</th><th>Lot</th><th>Message</th><th>Statut</th>
        </tr>
      ` + reqs.map(r => `
        <tr>
          <td><input value="${r.name || ''}" data-id="${r.id}" data-field="name" /></td>
          <td><input value="${r.email || ''}" data-id="${r.id}" data-field="email" /></td>
          <td><input value="${r.phone || ''}" data-id="${r.id}" data-field="phone" /></td>
          <td><input value="${r.lot || ''}" data-id="${r.id}" data-field="lot" /></td>
          <td><textarea data-id="${r.id}" data-field="message">${r.message || ''}</textarea></td>
          <td>
            <select data-id="${r.id}" data-field="statut">
              ${['Nouvelle','En cours','Cl√¥tur√©e'].map(s => `<option ${s===r.statut?'selected':''}>${s}</option>`).join('')}
            </select>
          </td>
        </tr>
      `).join('');
      table.querySelectorAll('input, textarea, select').forEach(el => el.addEventListener('change', editRequest));
    }

    function updateKpis() {
      const reqs = loadRequests();
      document.getElementById('kpiRow').innerHTML = `
        <div class="kpi"><div class="label">Cabanons</div><div class="value">${lotNames.length}</div></div>
        <div class="kpi"><div class="label">Places au port</div><div class="value">${lotNames.length}</div></div>
        <div class="kpi"><div class="label">Derni√®re AG</div><div class="value">12/03/2025</div></div>
        <div class="kpi"><div class="label">Demandes re√ßues</div><div class="value">${reqs.length}</div></div>
      `;
    }

    function renderTabs() {
      const nav = document.getElementById('tabsNav');
      const panels = document.getElementById('tabsPanels');
      nav.innerHTML = tabDefinitions.map((t, i) => `<button class="tab ${i===0?'active':''}" data-tab="${t.id}">${t.titre}</button>`).join('');
      panels.innerHTML = tabDefinitions.map((t, i) => `
        <div class="tab-panel ${i===0?'active':''}" data-tab="${t.id}">
          ${t.points.map(p => `<div class="meta">‚Ä¢ ${p}</div>`).join('')}
        </div>
      `).join('');
      nav.querySelectorAll('.tab').forEach(btn => btn.addEventListener('click', () => setTab(btn.dataset.tab)));
    }

    function setTab(tabId) {
      document.querySelectorAll('.tab').forEach(t => t.classList.toggle('active', t.dataset.tab === tabId));
      document.querySelectorAll('.tab-panel').forEach(p => p.classList.toggle('active', p.dataset.tab === tabId));
    }

    function renderServices() {
      const grid = document.getElementById('servicesGrid');
      grid.innerHTML = services.map(s => `
        <div class="card-sm">
          <div class="flag">${s.icon} ${s.titre}</div>
          <div class="meta">${s.texte}</div>
        </div>
      `).join('');
    }

    function renderFaq() {
      const wrap = document.getElementById('faqAccordion');
      wrap.innerHTML = faq.map((f, i) => `
        <div class="accordion-item ${i===0?'open':''}">
          <div class="accordion-header">${f.q}<span>${i===0?'-':'+'}</span></div>
          <div class="accordion-content">${f.a}</div>
        </div>
      `).join('');
      wrap.querySelectorAll('.accordion-item').forEach(item => {
        item.querySelector('.accordion-header').addEventListener('click', () => {
          const open = item.classList.toggle('open');
          item.querySelector('span').textContent = open ? '-' : '+';
        });
      });
    }

    function editRequest(e) {
      const { id, field } = e.target.dataset;
      const reqs = loadRequests();
      const idx = reqs.findIndex(r => r.id === id);
      if (idx === -1) return;
      reqs[idx][field] = e.target.value;
      saveRequests(reqs);
      toast('Demande mise √† jour et publi√©e hors connexion.');
    }

    function downloadReglement() {
      const content = `R√©sidence Thalassa - R√®glement de copropri√©t√©

` +
        `Parties communes : ponton, plage, terrain de beach-volley/golf, port (place de bateau privative).
` +
        `D√©termine la destination des parties privatives et communes et fixe les r√®gles de jouissance.

` +
        `R√®gles :
` +
        `- Pas de bruit apr√®s 00h (respect du voisinage et de la faune locale).
` +
        `- Animaux autoris√©s s‚Äôils ne troublent pas la tranquillit√©.
` +
        `- Utilisation du port r√©serv√©e aux r√©sidents (1 place par cabanon).
` +
        `- Plage et ponton : usage collectif, interdiction de privatiser des zones.
` +
        `- Terrain de beach-volley & golf : cr√©neaux partag√©s affich√©s sur place, sans r√©servation.
` +
        `- Propret√© : chaque r√©sident veille √† la propret√© des lieux communs.
` +
        `- Interdiction de feu de camp ou barbecue hors zones pr√©vues.

` +
        `AG 12 mars 2025 : 10 000 / 10 000 tanti√®mes. Naturisme parties communes rejet√© (3 r√©solutions). Naturisme sur parcelle d‚Äôeau privative adopt√© (Article 24). Bureau : Dupond / Flament / Petit.

` +
        `Dates cl√©s : pr√©sentation orale le 28 novembre (copro physiquement, composition, r√®glement niveau 5/6, EDD, lieu).
`;
      const blob = new Blob([content], { type: 'application/pdf' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'Reglement_Residence_Thalassa.pdf';
      a.click();
      URL.revokeObjectURL(url);
      toast('R√®glement PDF t√©l√©charg√©.');
    }

    function saveDraft() {
      const form = document.getElementById('requestForm');
      const data = Object.fromEntries(new FormData(form).entries());
      localStorage.setItem(draftKey, JSON.stringify({ data, date: new Date().toISOString() }));
      updateDraftStatus('Brouillon sauvegard√©.');
    }

    function restoreDraft() {
      const saved = JSON.parse(localStorage.getItem(draftKey) || 'null');
      if (!saved) return;
      const form = document.getElementById('requestForm');
      Object.entries(saved.data).forEach(([k, v]) => { if (form[k]) form[k].value = v; });
      updateDraftStatus(`Brouillon restaur√© (${new Date(saved.date).toLocaleTimeString()}).`);
    }

    function resetDraft() {
      document.getElementById('requestForm').reset();
      localStorage.removeItem(draftKey);
      updateDraftStatus('Brouillon r√©initialis√©.');
    }

    function updateDraftStatus(text) {
      document.getElementById('draftStatus').textContent = text;
    }

    function toast(message) {
      const t = document.getElementById('toast');
      t.textContent = message;
      t.classList.add('show');
      setTimeout(() => t.classList.remove('show'), 2400);
    }

    function openAdmin() {
      const login = prompt('Identifiant administrateur');
      const pwd = login ? prompt('Mot de passe') : '';
      if (login === 'TALASSA' && pwd === 'TALASSAVIVEZLEREVE') {
        isAdmin = true;
        document.getElementById('adminPanel').classList.remove('hidden');
        renderRequests();
        toast('Connexion r√©ussie.');
      } else {
        alert('Identifiants incorrects. Acc√®s refus√©.');
      }
    }

    function logout() {
      isAdmin = false;
      document.getElementById('adminPanel').classList.add('hidden');
      toast('Vous √™tes d√©connect√©.');
    }

    document.getElementById('requestForm').addEventListener('submit', submitRequest);
    document.getElementById('requestForm').addEventListener('input', () => { saveDraft(); });
    setInterval(saveDraft, 30000);

    populateLotOptions();
    restoreDraft();
    renderTabs();
    renderServices();
    renderFaq();
    updateKpis();
  </script>
</body>
</html>
